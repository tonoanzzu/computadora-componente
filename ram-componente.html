<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-dialog-scrollable/paper-dialog-scrollable.html">

<dom-module id="ram-componente">
    <template>
    <style>
      :host {
        display: block;
      }
      .tarjeta{
        display: block;
      }
      .paper-card {
        display: block;
      }
    </style>
    <template is="dom-if" if="[[!estado]]">
        
      <paper-card class="paper-card">
        <div class="card-content " align = "center">
          <span>[[seleccionado]]</span>
          <paper-button raised on-click="_dialogOpenRam">Detalles de Ram
          </paper-button>
        </div>
          <paper-dialog id="scrollingRam">
            <h2>Cambio de memoria Ram</h2>
              <paper-dialog-scrollable>
                <paper-listbox id="listaderams" > 
                  <template is="dom-repeat" items="{{listaRams}}">
                    <paper-item on-click="_selectedChanged">
                      <paper-item-body two-line>
                        <div>Elemento [[index]]</div>
                        <div secondary>{ Nombre: [[item.name]], Proveedor: [[item.provider]]  }</div>
                      </paper-item-body>
                    </paper-item>
                  </template>
    </paper-listbox>
    </paper-dialog-scrollable>
    <div class="buttons">
        <paper-button dialog-dismiss>Cancelar</paper-button>
        <paper-button on-click="actualizaRam" dialog-confirm autofocus>Actualizar</paper-button>
    </div>
    </paper-dialog>
    </div>
    </paper-card>

    </template>

    </template>


    <script>
        class RamComponente extends Polymer.Element {
            static get is() {
                return 'ram-componente';
            }
            static get properties() {
                return {
                    ram: {
                        type: Object,
                        value: {},
                        notify: true
                    },
                    estado: {
                        type: Boolean,

                    },
                    listaRams: {
                        type: Array,
                        value: []
                    },
                    itemSeleccionado: {
                        type: Object,
                        value: '_selectedChanged'
                    },
                    seleccionado: {
                        type: String,
                        value: "",
                    }

                };
            }

            actualizaRam() {
                if (Object.entries(this.itemSeleccionado).length === 0 && this.itemSeleccionado.constructor === Object) {
                    this.seleccionado = "No seleccionaste ninguno";
                } else {
                    this.seleccionado = this.itemSeleccionado.ramMemory;
                    this.ram = this.itemSeleccionado;
                }
            }

            connectedCallback() {
                super.connectedCallback();
                this._getAPIInformation();
            }

            _getAPIInformation() {
                let request = new XMLHttpRequest();
                let url = "http://demo6292426.mockable.io/ramMemory";
                request.open('GET', url);
                request.send();
                request.onreadystatechange = () => {
                    if (request.readyState === 4) {
                        console.log(JSON.parse(request.response));
                        this.listaRams = JSON.parse(request.response).data;
                    }
                }

                /* this.listaRams = [{
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "4GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-1"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "8GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-2"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "16GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "4GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "32GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "4GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "32GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "4GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-1"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "4GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-2"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "32GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "4GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "12GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "32GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }, {
                    "speed": "1600Mhz",
                    "releaseDate": "Mon Feb 06 1978 13:48:04 GMT+0000 (UTC)",
                    "price": "2441.74",
                    "architecture": "gigabite-GFT",
                    "ramMemory": "4GB",
                    "serial": 377,
                    "name": "ram-gigabite-377-Simple-GFT-patito-3"
                }] */

            }

            _dialogOpenRam() {
                this.itemSeleccionado = {};
                this.seleccionado = "No seleccionaste ninguno";
                this.shadowRoot.querySelector('#scrollingRam').open();
            }

            _selectedChanged(newValue, oldValue) {

                this.itemSeleccionado = newValue.model.item;
                //e.model.item //se deja referencia para uso con e.model
            }
        }

        window.customElements.define(RamComponente.is, RamComponente);
    </script>
</dom-module>