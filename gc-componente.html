<link rel="import" href="../polymer/polymer-element.html">
<link rel="import" href="../paper-listbox/paper-listbox.html">
<link rel="import" href="../paper-dialog-scrollable/paper-dialog-scrollable.html">

<dom-module id="gc-componente">
    <template>
    <style>
      :host {
        display: block;
      }
      .tarjeta{
          display: block;
      }
      .paper-card {
        display: block;
      }
    </style>

<template is="dom-if" if="[[!estado]]">
        <paper-card class="paper-card">
          <div class="card-content" align = "center">
                <span>[[seleccionado]]</span>
            <paper-button raised on-click="_dialogOpenGC">Detalles de Tarjeta Grafica
            </paper-button>
          </div>
          <paper-dialog id="scrollingGC">
              <h2>Cambio de tarjeta Grafica</h2>
              <paper-dialog-scrollable>
                <paper-listbox> 
                <template is="dom-repeat" items="{{listaGCs}}">
                    <paper-item on-click="_selectedChanged">
                        <paper-item-body two-line>
                            <div>Elemento [[index]]</div>
                            <div secondary> { Nombre: [[item.name]], Arquitectura: [[item.architecture]]  }</div>
                        </paper-item-body>
                    </paper-item>
                </template>
    </paper-listbox>
    </paper-dialog-scrollable>
    <div class="buttons">
        <paper-button dialog-dismiss>Cancelar</paper-button>
        <paper-button on-click="actualizaGC" dialog-confirm autofocus>Actualizar</paper-button>
    </div>
    </paper-dialog>
    </div>

    </paper-card>

    </template>

    </template>



    <script>
        class GCComponente extends Polymer.Element {
            static get is() {
                return 'gc-componente';
            }
            static get properties() {
                return {
                    gc: {
                        type: Object,
                        value: {},
                        notify: true
                    },
                    estado: {
                        type: Boolean,

                    },
                    listaGCs: {
                        type: Array,
                        value: []
                    },
                    seleccionado: {
                        type: String,
                        value: "",
                    }

                };
            }

            actualizaGC() {
                if (Object.entries(this.itemSeleccionado).length === 0 && this.itemSeleccionado.constructor === Object) {
                    this.seleccionado = "No seleccionaste ninguno"
                } else {
                    this.seleccionado = this.itemSeleccionado.name
                    this.gc = this.itemSeleccionado
                }



            }

            connectedCallback() {
                super.connectedCallback();
                this._getAPIInformation();
            }

            _getAPIInformation() {
                let request = new XMLHttpRequest();
                let url = "http://demo6292426.mockable.io/graphicCard";
                request.open('GET', url);
                request.send();
                request.onreadystatechange = () => {
                        if (request.readyState === 4) {
                            console.log(JSON.parse(request.response));
                            this.listaGCs = JSON.parse(request.response).data;
                        }
                    }
                    /* 
                                   this.listaGCs = [{
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-1",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-1"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-2",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-2"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-3",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-3"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-1",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-1"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-2",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-2"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-3",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-3"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-1",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-1"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-2",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-2"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-3",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-3"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-1",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-1"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-2",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-2"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-3",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-3"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-1",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-1"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-2",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-2"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-3",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-3"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-1",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-1"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-2",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-2"
                                   }, {
                                       "overclock": true,
                                       "releaseDate": "Fri Jan 23 2004 03:09:46 GMT+0000 (UTC)",
                                       "price": "3966.13",
                                       "architecture": "nvidia-GFT-PATITO-3",
                                       "ramMemory": "16GB",
                                       "serial": 1057,
                                       "name": "card-nvidia-1057-GFT-PATITO-3"
                                   }] */
            }

            _dialogOpenGC() {
                this.itemSeleccionado = {}
                this.seleccionado = "No seleccionaste ninguno"
                this.shadowRoot.querySelector('#scrollingGC').open();
            }

            _selectedChanged(newValue, oldValue) {

                this.itemSeleccionado = newValue.model.item;
                //e.model.item //se deja referencia para uso con e.model
            }
        }

        window.customElements.define(GCComponente.is, GCComponente);
    </script>
</dom-module>